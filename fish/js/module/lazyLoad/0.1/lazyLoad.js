(function(){function e(b,a){var c={preSpace:0,failurelimit:10,attr:"orisrc",container:window,aniTime:300};b&&fish.lang.extend(c,b);setTimeout(function(){d(a,c)},2E3);f(a,c);fish.one(c.container).on("scroll",function(){d(a,c)})}function f(b,a){b.each&&b.each(function(){undefined==fish.one(this).attr(a.attr)&&fish.one(this).attr(a.attr,fish.one(this).attr("src"));if(a.placeholder)fish.one(this).attr("src",a.placeholder);else{var c=fish.one(this);c.attr("src",g);c[0].style.cssText="background:url("+
h+") scroll no-repeat center center #fff"}this.loaded=false})}function d(b,a){a.timer&&clearTimeout(a.timer);a.timer=setTimeout(function(){var c=0;b.each(function(){if(!((a.container===undefined||a.container===window?fish.one(window).scrollTop():fish.one(a.container).offset().top)>=fish.one(this).offset().top+a.preSpace+fish.one(this).height()||(a.container===undefined||a.container===window?fish.one(window).scrollLeft():fish.one(a.container).offset().left)>=fish.one(this).offset().left+a.preSpace+
fish.one(this).width()))if(!((a.container===undefined||a.container===window?fish.one(window).height()+fish.one(window).scrollTop():fish.one(a.container).offset().top+fish.one(a.container).height())<=fish.one(this).offset().top-a.preSpace)&&!((a.container===undefined||a.container===window?fish.one(window).width()+fish.one(window).scrollLeft():fish.one(a.container).offset().left+fish.one(a.container).width())<=fish.one(this).offset().left-a.preSpace))i(this,a);else if(c++>a.failurelimit)return false})},
100)}function i(b,a){var c=fish.one(b);if(!b.loaded){c.attr("src",c.attr(a.attr));b.removeAttribute(a.attr);c.onerror=function(){b.err=true}}}var h="http://img1.40017.cn/cn/comm/images/cn/public/transparent_loading.gif",g="http://img1.40017.cn/cn/new_ui/public/images/transparent.gif";fish.extend({lazyLoad:function(b){e(b,this)}})})();
