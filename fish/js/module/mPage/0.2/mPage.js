(function(){function g(a){if(a.url){this.param=a;this.param.startWithAjax=this.param.startWithAjax!=null?this.param.startWithAjax:true;this.init()}}var i=/{pagenum}/i;g.appendA=function(a,c,b,f){var d=document.createElement("a");d.innerHTML=a;var e=g.changeText(a,f);d.className=e.cls?c+" "+e.cls:c;if(parseInt(e.pageNum)>0)d.onclick=function(){f.CURRENT_PAGE!=e.pageNum&&f.paging(e.pageNum)};b.appendChild(d);return d};g.changeText=function(a,c){var b={};switch(a){case "\u9996\u9875":if(c.CURRENT_PAGE-
1<=0){b.pageNum=-3;b.cls="indexGrey"}else{b.pageNum=1;b.cls="indexNormal"}break;case "\u4e0a\u4e00\u9875":if(c.CURRENT_PAGE-1<=0){b.pageNum=-1;b.cls="prevGrey"}else{b.pageNum=c.CURRENT_PAGE-1;b.cls="prevNormal"}break;case "\u4e0b\u4e00\u9875":if(c.CURRENT_PAGE+1>c.TOTAI_SIZE){b.pageNum=-2;b.cls="nextGrey"}else{b.pageNum=c.CURRENT_PAGE+1;b.cls="nextNormal"}break;case "\u672b\u9875":if(c.CURRENT_PAGE+1>c.TOTAI_SIZE){b.pageNum=-4;b.cls="lastGrey"}else{b.pageNum=c.TOTAI_SIZE;b.cls="lastNormal"}break;
default:b.pageNum=a}return b};g.prototype={init:function(){this.CURRENT_PAGE=this.num=1;if(this.param.startWithAjax)this.paging(1);else this.param.size&&this.build(this.param.size)},paging:function(a){a=a<=0?1:a;if(this.TOTAI_SIZE)a=a>this.TOTAI_SIZE?this.TOTAI_SIZE:a;var c=this,b,f=false;if(this.param.url.indexOf("{pagenum}")>0)b=this.param.url.replace(i,a);else{f=true;b=/\?/i.test(this.param.url)?this.param.url+"&"+this.param.args.pageNO+"="+a:this.param.url+"?"+this.param.args.pageNO+"="+a}typeof this.param.beforeAjaxFn===
"function"&&this.param.beforeAjaxFn.call(this,a);fish.ajax({url:b,type:this.param.ajaxType||"json",fn:function(d){c.CURRENT_PAGE=c.now=a;f&&d&&d.totalSize&&c.build(d.totalSize,a);c.param.callback.call(c,d,a)}})},build:function(a){var c=parseInt(a,10);if(c==1)this.param.appendTo.html("");else{this.TOTAI_SIZE=c;var b=this;this.param.appendTo.html("");a=document.createElement("div");a.className="bag_page";if(this.param.skip){var f=document.createElement("input");f.type="text";f.value=b.CURRENT_PAGE;
a.appendChild(f);var d=document.createElement("input");d.type="button";d.value="\u8df3\u8f6c";d.onclick=function(){var j=parseInt(f.value)>c?c:parseInt(f.value);b.paging(j)};a.appendChild(d)}if(typeof this.param.firstLast=="undefined"||this.param.firstLast)g.appendA("\u9996\u9875","guidnum",a,this);if(typeof this.param.prevNext=="undefined"||this.param.prevNext)g.appendA("\u4e0a\u4e00\u9875","guidnum",a,this);var e=1;d=1;if(c>6)if(b.CURRENT_PAGE==1||b.CURRENT_PAGE>c-3){e=1;d=3}else if(b.CURRENT_PAGE==
c-3){e=b.CURRENT_PAGE-2;d=b.CURRENT_PAGE}else{e=b.CURRENT_PAGE-1;d=b.CURRENT_PAGE+1}else{e=1;d=c}for(;e<=d;e++){var h=e==b.CURRENT_PAGE?"pagenum currentpage":"pagenum";g.appendA(e,h,a,this)}if(c>6){d=document.createElement("span");d.innerHTML="...";d.className="mr10";a.appendChild(d);for(e=c-2;e<=(c>6?c:0);e++){h=e==b.CURRENT_PAGE?"pagenum currentpage":"pagenum";g.appendA(e,h,a,this)}}if(typeof this.param.prevNext=="undefined"||this.param.prevNext)g.appendA("\u4e0b\u4e00\u9875","guidnum",a,this);
if(typeof this.param.firstLast=="undefined"||this.param.firstLast)g.appendA("\u672b\u9875","guidnum",a,this);this.param.appendTo[0].appendChild(a)}}};fish.extend({mPage:function(a){a.appendTo=this;return new g(a)}})})();
